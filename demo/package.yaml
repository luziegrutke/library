id: demo
name: Demo Node Pipelines
author: Tenzir
author_icon: https://github.com/tenzir.png

description: |
  These pipelines import recorded network data from the M57-Patents [1] company,
  a forensics research corpus generated by Woods et al. (2011).

  This package is installed on our demo nodes in order to provide some example data
  for users to try out their pipelines.

  [1] https://digitalcorpora.org/corpora/scenarios/m57-patents-scenario/

pipelines:
  m57-suricata:
    name: M57 Suricata
    description: This pipeline imports the suricata data of the M57 dataset.
    definition: |
      from https://storage.googleapis.com/tenzir-datasets/M57/suricata.json.zst read suricata --no-infer
      | where #schema != "suricata.stats"
      | import

  m57-zeek:
    name: M57 Zeek
    description: |
      from https://storage.googleapis.com/tenzir-datasets/M57/zeek-all.log.zst read zeek-tsv
      | import

snippets:
  - name: Taste Operator
    description: Get a “taste” of your input
    definition: export | taste

  - name: Where Operator
    description: Zero in on one particular schema
    definition: export | where #schema == "suricata.alert"

  - name: Expressions
    description: Apply more involved expressions
    definition: export | where 10.10.5.0/25 && (orig_bytes > 1 Mi || duration > 30 min)

  - name: Top Operator
    description: Identify top hitters
    definition: export | where #schema == "zeek.notice" | top msg | head 5
